function renderEvent(data) {
    let html = `<h2>${data.title}</h2>`;
    html += `<strong>Date:</strong> <div>${data.date || ''}</div><br>`;
    html += `<strong>Location:</strong> <div>${data.location || ''}</div><br>`;
    html += `<strong>Description:</strong> <div>${data.description || ''}</div><br>`;
    html += `<strong>Organizer:</strong> <div>${data.organizer || ''}</div><br>`;
    html += `<strong>Contact:</strong> <div>${data.contact || ''}</div><br>`;
    if (data.imageUrl) {
        html += `<img src="${data.imageUrl}" alt="Event Image" style="max-width:300px;border-radius:8px;margin:1em 0;" /><br>`;
    }
    html += `<button id="edit-btn">Edit</button>`;
    document.getElementById('event-details').innerHTML = html;
    document.getElementById('edit-btn').onclick = function() {
        showEditForm(data);
    };
}
function showEditForm(data) {
    document.getElementById('event-details').style.display = 'none';
    document.body.insertAdjacentHTML('beforeend', `<section id="edit-section" style="max-width:700px;margin:auto;background:#fafafa;padding:2em;border-radius:12px;position:relative;z-index:10;">
        <h2>Edit Event</h2>
        <form id="edit-form">
            <label>Title:<br><input type="text" name="title" value="${data.title}" required></label><br>
            <label>Date:<br><input type="date" name="date" value="${data.date || ''}" required></label><br>
            <label>Location:<br><input type="text" name="location" value="${data.location || ''}" required></label><br>
            <label>Description:<br><textarea name="description" required>${data.description || ''}</textarea></label><br>
            <label>Organizer:<br><input type="text" name="organizer" value="${data.organizer || ''}" required></label><br>
            <label>Contact:<br><input type="text" name="contact" value="${data.contact || ''}" required></label><br>
            <label>Image URL:<br><input type="text" name="imageUrl" value="${data.imageUrl || ''}"></label><br>
            <button type="submit">Save Changes</button>
        </form>
        <div id="edit-status" style="margin-top:1em;"></div>
    </section>`);
    document.getElementById('edit-form').onsubmit = function(e) {
        e.preventDefault();
        var form = e.target;
        var updated = {
            title: form.title.value,
            date: form.date.value,
            location: form.location.value,
            description: form.description.value,
            organizer: form.organizer.value,
            contact: form.contact.value,
            imageUrl: form.imageUrl.value
        };
        db.collection('events').doc(id).update(updated).then(function() {
            document.getElementById('edit-status').innerText = 'Event updated!';
            document.getElementById('edit-section').remove();
            document.getElementById('event-details').style.display = 'block';
            loadEvent();
        }).catch(function(err) {
            document.getElementById('edit-status').innerText = 'Error: ' + err.message;
        });
    };
}
function loadEvent() {
    db.collection('events').doc(id).get().then(function(doc) {
        if (!doc.exists) {
            document.getElementById('event-details').innerHTML = '<p style="color:red;">Event not found.</p>';
            return;
        }
        renderEvent(doc.data());
    }).catch(function(err) {
        document.getElementById('event-details').innerHTML = `<p style='color:red;'>Error loading event: ${err.message}</p>`;
    });
}
loadEvent();